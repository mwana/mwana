{% extends "layout.html" %}
{% load url from future %}
{% load forms_tags django_tables2 %}
{% load render_table from django_tables2 %}

{% block title %}RemindMI - Children{% endblock title %}

{% block extra_stylesheets %}
    <link type="text/css" rel="stylesheet"
          href="{{ STATIC_URL }}appointments/stylesheets/appointments.css" />
    <link type="text/css" rel="stylesheet"
          href="{{ STATIC_URL }}malawi/stylesheets/daterangepicker-bs2.css" />
    <style>
.table-container ul.pagination {
    overflow: auto;
    margin: 0;
    padding: 5px;
    border: 1px solid #DDD;
    list-style: none;
}
.table-container ul.pagination > li > a {
    text-decoration: none;
    font-weight: bold;
}
.table-container ul.pagination li {
    float: left;
    line-height: 22px;
    margin-left: 10px;
}
.table-container ul.pagination li:first-child {
    margin-left: 0;
}

.table-container ul.pagination li.cardinality {
    float: right;
    color: #8d8d8d;
}

.report-exports {
       margin: -60px 0 50px 0;
       float:right;
     }
    </style>

{% endblock extra_stylesheets %}

{% block javascripts %}
{{ block.super }}
<script type="text/javascript"
        src="{{ STATIC_URL }}malawi/javascripts/moment.min.js"></script>
<script type="text/javascript"
        src="{{ STATIC_URL }}malawi/javascripts/daterangepicker.js"></script>
<script type="text/javascript">
$(document).ready(function() {
  $('#reportrange').daterangepicker(
     {
        startDate: moment().subtract('days', 29),
        endDate: moment(),
        minDate: '01/01/2008',
        maxDate: '01/01/2018',
        // maxDate: moment(),
        dateLimit: { days: 3650 },
        showDropdowns: true,
        showWeekNumbers: true,
        timePicker: false,
        timePickerIncrement: 1,
        timePicker12Hour: true,
        ranges: {
           'Today': [moment().startOf('day'), moment()],
           'Yesterday': [moment().subtract('days', 1), moment().subtract('days', 1)],
           'Last 7 Days': [moment().subtract('days', 6), moment()],
           'Last 30 Days': [moment().subtract('days', 29), moment()],
           'This Month': [moment().startOf('month'), moment().endOf('month')],
           'Last Month': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')],
           'Last Year': [moment().startOf('year').subtract('year', 1), moment().startOf('year')],
           'Project Start to Present Day': [moment([2010, 10, 01]), moment()],
        },
        opens: 'right',
        buttonClasses: ['btn btn-default'],
        applyClass: 'btn-small btn-primary',
        cancelClass: 'btn-small',
        format: 'MM/DD/YYYY',
        separator: ' to ',
        locale: {
            applyLabel: 'Submit',
            fromLabel: 'From ',
            toLabel: 'To ',
            customRangeLabel: 'Custom Range',
            daysOfWeek: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr','Sa'],
            monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
            firstDay: 1
        }
     },
     function(start, end) {
      console.log("Callback has been called!");
      $('#reportrange span').html(start.format('YYYY-MM-DD') + ' - ' + end.format('YYYY-MM-DD'));
      $('#id_startdate').val(start.format('YYYY-MM-DD'));
      $('#id_enddate').val(end.format('YYYY-MM-DD'));
     }
  );
  //Set the initial state of the picker label
   if ($('#id_startdate').val() === ""){
     default_start = moment().subtract('days', 29)
     $('#id_startdate').val(default_start.format('YYYY-MM-DD'))
   }
   if ($('#id_enddate').val() === ""){
     default_end = moment().format('YYYY-MM-DD')
     $('#id_enddate').val(default_end)
   }
   /* $('#reportrange span').html(); */
   $('#reportrange span').html($('#id_startdate').val() + ' - ' + $('#id_enddate').val());
});

</script>
{% endblock javascripts %}

{% block content %}
    <div class="span12" id="remindmi">
        <div class="page-header"><h1>RemindMI Children</h1></div>
        <div class="row-fluid">
            <div class="span3">
                <form id="filter-form" method="GET">
                   <p>Registration Date Range</p>
                  <div id="reportrange" class="pull-right daterangepicker"
                  style="background: #fff; cursor: pointer;
                  padding: 5px 10px;; border: 1px solid #ccc;
                  position:relative; float: left; min-width:80%;
                  top:0; left:0; margin-bottom:17px; clear:right;">
                  <i class="glyphicon glyphicon-calendar icon-calendar icon-large"></i>
                  <span></span><b class="caret" style="float:right"></b>
                  </div>
                  {{ filter.form.as_p }}
                  <input class="btn btn-primary" type="submit" value="Update Filters" />
                  <a class="btn" href="{% url 'children_list' %}">Clear Filters</a>
                </form>
            </div>
            <div class="span9">
              {% render_table table %}
            </div>
        </div>
    </div>
{% endblock content %}


{% render_table table %}
